##### Prefix #####
# Remap prefix from C-b to C-q
unbind C-b
set -g prefix C-q
bind C-q send-prefix


# Reload tmux config
bind r source-file ~/.tmux.conf \; display-message "tmux config reloaded ✔"

# Only apply on Amazon Linux
if-shell 'grep -qi amazon /etc/os-release' {
  set -g default-terminal "screen-256color"
  set -as terminal-overrides ",xterm-256color:Tc"
}

##### Indexing #####
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on


##### Window navigation #####

# Start windows at 1 and keep them compact
set -g base-index 1
set -g renumber-windows on

# Disable automatic renaming (manual naming only)
set -g automatic-rename off

# Cycle windows (no prefix)
bind -n M-H previous-window
bind -n M-L next-window

# Quick rename (prefix + ,)
bind , command-prompt -I "#W" "rename-window '%%'"

# Fuzzy picker: sessions / windows / panes
bind w choose-tree -Zw

# (Optional) windows-only picker
bind W choose-window

##### Splits & windows #####
unbind '"'
unbind %
bind c new-window -c "#{pane_current_path}"
bind = split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

##### Pane navigation (tmux-native) #####
set -g mode-keys vi

# use funky characters in ghostty to be able to do tmux stuff
bind-key -n ç new-window # Super N 
bind-key -n ¬ next-window # Super+shift+bracket_left
bind-key -n ˙ previous-window # Super+shift+bracket_right
bind-key -n ≈ kill-window # Super K

# Vim-style pane selection WITH prefix
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# option-arrows WITHOUT prefix
bind -n M-Left  select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up    select-pane -U
bind -n M-Down  select-pane -D


##### Window navigation #####
# Shift arrows WITHOUT prefix
bind -n S-Left  previous-window
bind -n S-Right next-window

# option-Shift vim keys WITHOUT prefix (as you had)
bind -n M-H previous-window
bind -n M-L next-window


##### Copy mode (vi) #####
bind-key -T copy-mode-vi v   send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y   send-keys -X copy-selection-and-cancel


##### Pane sync toggle #####
# Toggle synchronize-panes with "m"
bind m setw synchronize-panes\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"

##### Fun popups
set -g @popup_w "95%"
set -g @popup_h "90%"

# Scratch pad popup
bind -n '◈' run-shell "~/tmux-scripts/scratch-popup.sh '#{pane_current_path}' '#{session_name}' '#{window_name}' '#{@popup_w}' '#{@popup_h}'"

# claude or codex popup 
set-environment -g LLM_ASSISTANT "codex"
bind -n '▸' run-shell "~/tmux-scripts/llm-popup-toggle.sh '#{pane_current_path}' '#{session_name}' '#{window_name}' '#{@popup_w}' '#{@popup_h}'"

##### Plugins #####
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# Seamless nav between nvim splits and tmux panes
set -g @plugin 'christoomey/vim-tmux-navigator'

# Clipboard yank integration
set -g @plugin 'tmux-plugins/tmux-yank'

# Theme: Dracula (use this one theme)
set -g @plugin 'dracula/tmux'

# (Optional) Dracula config examples:
set -g @dracula-show-powerline true
set -g @dracula-show-left-icon session
set -g @dracula-plugins "cpu-usage ram-usage battery time"

run '~/.tmux/plugins/tpm/tpm'


